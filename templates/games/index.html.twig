{% extends 'base.html.twig' %}

{% block title %}
	Accueil
{% endblock %}

{% block stylesheets %}
	<link href="{{asset('/css/games.css')}}" type="text/css" rel="stylesheet">
{% endblock %}

{% block body %}
	<div class="container">
		<div class="row">
			{% for g in games %}
				<div class="col-sm-4 mb-4">
					<div class="card" style="width: 18rem;">
						<div class="card-body">
							<h5 class="card-title">{{g.title}}</h5>
							<h6 class="card-subtitle mb-2 text-muted">{{g.publishers}}</h6>
							<div>
								<script>
									fetch('https://api.rawg.io/api/games?search="{{ g.title }}"')
											.then(res => res.json())
											.then((out) => {
												return document.getElementById('dynamicImg{{ g.idGame }}').src = (out.results[0].background_image);
											}).catch(err => console.error(err))
								</script>
								<img class="card-image" id="dynamicImg{{ g.idGame }}" src="" onerror="this.src='{{asset('/images/default.jpg')}}'" />
							</div>
							<p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
							{% set genres = g.genres | split(',') %}
							{% for genre in genres  %}
								<div class="badge badge-primary text-wrap" style="width: fit-content;">
									{{ genre }}
								</div>
							{% endfor %}
						</div>
						<a href="#" class="btn btn-secondary btn-buy">Acheter le jeu</a>
					</div>
				</div>
			{% endfor %}
		</div>
	</div>
{% endblock %}
